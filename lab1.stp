global time_start, cnt_read, cnt_write, cnt_open, cnt_close, cnt_futex

probe begin {
   time_start = gettimeofday_s()
   cnt_read = 0
   cnt_write = 0
   cnt_open = 0
   cnt_close = 0
}

probe syscall.cnt_write {
   if (execname() == "lab1.out")
   	cnt_write += 1
}

probe syscall.cnt_read {
   if (execname() == "lab1.out")
   	cnt_read += 1
}

probe syscall.cnt_open {
   if (execname() == "lab1.out")
   	cnt_open += 1
}

probe syscall.cnt_close {
   if (execname() == "lab1.out")
   	cnt_close += 1
}

probe syscall.cnt_futex {
   if (execname() == "lab1.out")
      cnt_futex += 1
}

probe timer.ms(100) {
   printf("%d\t%d\t%d\t%d\t%d\t%16d\n", cnt_read, cnt_write, cnt_open, cnt_close, cnt_futex, task_stime())
   cnt_read = 0
   cnt_write = 0
   cnt_open = 0
   cnt_close = 0
   cnt_futex = 0
}
